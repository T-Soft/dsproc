версия 2
2016-08-22



ключ smev3_charge.enveloped - подписание чиновником в рамках СМЭВ-3 пока не реализуется



ключ указания тип подписания:

sig.detached 
smev2_base.detached 
smev2_charge.enveloped
smev2_sidebyside.detached
smev3_base.detached


sign:

sig.detached 
	?



-smev2
smev2_base.detached 
	передаем готовый xml в формате СМЭВ-2 (wsu)
	не указвается id

-smev2 -enveloped
smev2_charge.enveloped
	передаем на подписание контейнер с бизнес данными, который подписывается целиком
	важно если используются ns - их так же передать черех атрибуты xmlns:*
	не указвается id 

-sidebyside
smev2_sidebyside.detached
	указываем id контейнера для подписания, ставится строго рядом с подписываемым контейнером
	используется для внутреннего взаимодействия unisign

-smev3
smev3_base.detached
	передаем готовый xml в формате СМЭВ-3	
	указываем id контейнера для подписания



ЕСТЬ НО В UNIDSPROC НЕ ИСПОЛЬЗУЕТСЯ - используется только для ACK пакетов в unismev:
smev3_base_ack.detached
	передаем готовый xml в формате СМЭВ-3 только для ACK
	указываем id контейнера для подписания




verify:

smev2_charge.enveloped
	во входном файле контейнер с бизнес данным.
	т.к. отсутствует id то требования к xml усложнены:
	- если в бизнес данных есть ns - то корневой элемент бизнес данных помещается в root* элемент в котором все ns описываются
	- контейнер Signature должен быть или ребенком корневого элемента или ребенком единственного ребенка корневого элемента root*
	- контейнер Signature должен быть представлен в единственном числе во всем контейнере с бизнес данными

	используется для проверки подписания начислений и в будущем СЭЗ

smev2_sidebyside.detached
	указываем id контейнера для проверки
	используется для внутреннего взаимодействия unisign

smev3_base.detached
	указываем id контейнера для проверки 



extract

-source=xml	в исходном файле лежит xml
-source=base64	в исходном файле лежит только base64 из X509Certificate
-source=cer	в исходном файле лежит cer-файл (DER кодировка)


нет ключа типа smev*_*.*

	указывается id подписанного контейнера или программа берет первую попавшуюся подпись
	файл источник - или оригинальный xml файл или base64 из X509Certificate








